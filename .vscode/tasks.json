{
  //===-------------------------------------------------------------------------===//
  // CMake Task Configuration for AlgoDataStruct Project
  //
  // Task Organization:
  //   1. Configuration tasks - Set up CMake with different build types
  //   2. Build tasks - Compile targets with parallel jobs
  //   3. Clean tasks - Remove and reconfigure build directories
  //   4. Run tasks - Execute built binaries
  //   5. Utility tasks - Format and lint operations
  //
  // Build Types:
  //   Debug           - Standard debug build (build/${input:toolchain}/debug/)
  //   Release         - Optimized production build (build/${input:toolchain}/release/)
  //   Sanitize        - AddressSanitizer + UBSan (build/${input:toolchain}/sanitize/)
  //   Sanitize+Tests  - ASan + UBSan with GoogleTest (build/${input:toolchain}/sanitize-tests/)
  //   ThreadSanitize  - ThreadSanitizer (build/${input:toolchain}/thread-sanitize/)
  //   Debug+Tests     - GoogleTest enabled (build/${input:toolchain}/debug-tests/)
  //
  // Common Variables:
  //   ${input:toolchain}      - Toolchain family (clang|gcc)
  //   ${input:buildJobs}       - Parallel compilation jobs
  //   ${workspaceFolder}       - Project root directory
  //===-------------------------------------------------------------------------===//
  "version": "2.0.0",

  "tasks": [
    //===------------------------- CONFIGURATION TASKS -------------------------===//
    // These tasks configure CMake with different build types and options.
    // They create separate build directories for each configuration.

    {
      "label": "CMake: Configure (Debug)",
      "type": "shell",
      "command": "cmake",
      "args": [
        "-DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake",
        "-DCMAKE_BUILD_TYPE=Debug",
        "-DENABLE_TESTING=OFF",
        "-B",
        "build/${input:toolchain}/debug"
      ],
      "problemMatcher": [],
      "detail": "Configure Debug build with selected toolchain"
    },
    {
      "label": "CMake: Configure (Release)",
      "type": "shell",
      "command": "cmake",
      "args": [
        "-DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake",
        "-DCMAKE_BUILD_TYPE=Release",
        "-B",
        "build/${input:toolchain}/release"
      ],
      "problemMatcher": [],
      "detail": "Configure Release build with optimizations"
    },
    {
      "label": "CMake: Configure (Sanitize)",
      "type": "shell",
      "command": "cmake",
      "args": [
        "-DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake",
        "-DCMAKE_BUILD_TYPE=Sanitize",
        "-DENABLE_TESTING=OFF",
        "-B",
        "build/${input:toolchain}/sanitize"
      ],
      "problemMatcher": [],
      "detail": "Configure with AddressSanitizer + UndefinedBehaviorSanitizer"
    },
    {
      "label": "CMake: Configure (Sanitize + Tests)",
      "type": "shell",
      "command": "cmake",
      "args": [
        "-DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake",
        "-DCMAKE_BUILD_TYPE=Sanitize",
        "-DENABLE_TESTING=ON",
        "-B",
        "build/${input:toolchain}/sanitize-tests"
      ],
      "options": {
        "env": { "CPATH": "" }
      },
      "problemMatcher": [],
      "detail": "Configure sanitizer build with GoogleTest support"
    },
    {
      "label": "CMake: Configure (ThreadSanitize)",
      "type": "shell",
      "command": "cmake",
      "args": [
        "-DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake",
        "-DCMAKE_BUILD_TYPE=ThreadSanitize",
        "-DENABLE_TESTING=OFF",
        "-B",
        "build/${input:toolchain}/thread-sanitize"
      ],
      "problemMatcher": [],
      "detail": "Configure with ThreadSanitizer"
    },
    {
      "label": "CMake: Configure (ThreadSanitize + Tests)",
      "type": "shell",
      "command": "cmake",
      "args": [
        "-DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake",
        "-DCMAKE_BUILD_TYPE=ThreadSanitize",
        "-DENABLE_TESTING=ON",
        "-B",
        "build/${input:toolchain}/thread-sanitize-tests"
      ],
      "options": {
        "env": { "CPATH": "" }
      },
      "problemMatcher": [],
      "detail": "Configure ThreadSanitizer build with GoogleTest support"
    },
    {
      "label": "CMake: Configure (Debug + Tests)",
      "type": "shell",
      "command": "cmake",
      "args": [
        "-DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake",
        "-DCMAKE_BUILD_TYPE=Debug",
        "-DENABLE_TESTING=ON",
        "-B",
        "build/${input:toolchain}/debug-tests"
      ],
      "options": {
        "env": { "CPATH": "" }
      },
      "problemMatcher": [],
      "detail": "Configure Debug build with GoogleTest support"
    },

    //===----------------------------- BUILD TASKS -----------------------------===//
    // These tasks compile the project using the configured build directory.
    // Parallel jobs are configurable via input variable.

    {
      "label": "CMake: Build All",
      "type": "shell",
      "command": "sh",
      "args": [
        "-c",
        "if [ ! -f build/${input:toolchain}/debug/CMakeCache.txt ]; then cmake -DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake -DCMAKE_BUILD_TYPE=Debug -DENABLE_TESTING=OFF -B build/${input:toolchain}/debug; fi && cmake --build build/${input:toolchain}/debug -j${input:buildJobs}"
      ],
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "problemMatcher": ["$gcc"],
      "detail": "Incremental Debug build (auto-configures once if missing)"
    },
    {
      "label": "CMake: Build (Debug + Tests)",
      "type": "shell",
      "command": "cmake",
      "args": ["--build", "build/${input:toolchain}/debug-tests", "-j${input:buildJobs}"],
      "options": {
        "env": { "CPATH": "" }
      },
      "group": "build",
      "dependsOn": ["CMake: Configure (Debug + Tests)"],
      "problemMatcher": ["$gcc"],
      "detail": "Build all targets with GoogleTest enabled"
    },
    {
      "label": "CMake: Build (Sanitize)",
      "type": "shell",
      "command": "sh",
      "args": [
        "-c",
        "if [ \"${input:toolchain}\" = \"gcc\" ] && [ \"$(uname)\" = \"Darwin\" ]; then echo \"GCC sanitizer builds are not supported on macOS in this setup. Use toolchain=clang for sanitizer debug sessions.\"; exit 2; fi; if [ ! -f build/${input:toolchain}/sanitize/CMakeCache.txt ]; then cmake -DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake -DCMAKE_BUILD_TYPE=Sanitize -DENABLE_TESTING=OFF -B build/${input:toolchain}/sanitize; fi && cmake --build build/${input:toolchain}/sanitize -j${input:buildJobs}"
      ],
      "group": "build",
      "problemMatcher": ["$gcc"],
      "detail": "Incremental Sanitize build (auto-configures once if missing)"
    },
    {
      "label": "CMake: Build (Sanitize + Tests)",
      "type": "shell",
      "command": "cmake",
      "args": ["--build", "build/${input:toolchain}/sanitize-tests", "-j${input:buildJobs}"],
      "options": {
        "env": { "CPATH": "" }
      },
      "group": "build",
      "dependsOn": ["CMake: Configure (Sanitize + Tests)"],
      "problemMatcher": ["$gcc"],
      "detail": "Build sanitizer targets with GoogleTest enabled"
    },
    {
      "label": "CMake: Build (ThreadSanitize)",
      "type": "shell",
      "command": "sh",
      "args": [
        "-c",
        "if [ \"${input:toolchain}\" = \"gcc\" ] && [ \"$(uname)\" = \"Darwin\" ]; then echo \"GCC thread sanitizer builds are not supported on macOS in this setup. Use toolchain=clang for TSan debug sessions.\"; exit 2; fi; if [ ! -f build/${input:toolchain}/thread-sanitize/CMakeCache.txt ]; then cmake -DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake -DCMAKE_BUILD_TYPE=ThreadSanitize -DENABLE_TESTING=OFF -B build/${input:toolchain}/thread-sanitize; fi && cmake --build build/${input:toolchain}/thread-sanitize -j${input:buildJobs}"
      ],
      "group": "build",
      "problemMatcher": ["$gcc"],
      "detail": "Incremental ThreadSanitize build (auto-configures once if missing)"
    },
    {
      "label": "CMake: Build (ThreadSanitize + Tests)",
      "type": "shell",
      "command": "cmake",
      "args": ["--build", "build/${input:toolchain}/thread-sanitize-tests", "-j${input:buildJobs}"],
      "options": {
        "env": { "CPATH": "" }
      },
      "group": "build",
      "dependsOn": ["CMake: Configure (ThreadSanitize + Tests)"],
      "problemMatcher": ["$gcc"],
      "detail": "Build ThreadSanitizer targets with GoogleTest enabled"
    },
    {
      "label": "CMake: Build Test Target [src/]",
      "type": "shell",
      "command": "cmake",
      "args": ["--build", "build/${input:toolchain}/debug", "--target", "${input:testTarget}", "-j${input:buildJobs}"],
      "group": "build",
      "problemMatcher": ["$gcc"],
      "detail": "Build specific test target from src/"
    },
    {
      "label": "CMake: Build App Target [apps/]",
      "type": "shell",
      "command": "cmake",
      "args": ["--build", "build/${input:toolchain}/debug", "--target", "${input:appTarget}", "-j${input:buildJobs}"],
      "group": "build",
      "problemMatcher": ["$gcc"],
      "detail": "Build specific app target from apps/"
    },

    //===----------------------------- CLEAN TASKS -----------------------------===//
    // These tasks clean or completely remove build directories.

    {
      "label": "CMake: Clean",
      "type": "shell",
      "command": "cmake",
      "args": ["--build", "build/${input:toolchain}/debug", "--target", "clean"],
      "problemMatcher": [],
      "detail": "Clean build artifacts without removing configuration"
    },
    {
      "label": "CMake: Clean & Reconfigure (Debug)",
      "type": "shell",
      "command": "sh",
      "args": [
        "-c",
        "cmake -E remove_directory build/${input:toolchain}/debug && cmake -DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake -DCMAKE_BUILD_TYPE=Debug -DENABLE_TESTING=OFF -B build/${input:toolchain}/debug"
      ],
      "problemMatcher": [],
      "detail": "Remove build/${input:toolchain}/debug/ directory and reconfigure for Debug"
    },
    {
      "label": "CMake: Clean & Reconfigure (Debug + Tests)",
      "type": "shell",
      "command": "sh",
      "args": [
        "-c",
        "cmake -E remove_directory build/${input:toolchain}/debug-tests && cmake -DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake -DCMAKE_BUILD_TYPE=Debug -DENABLE_TESTING=ON -B build/${input:toolchain}/debug-tests"
      ],
      "options": {
        "env": { "CPATH": "" }
      },
      "problemMatcher": [],
      "detail": "Remove build/${input:toolchain}/debug-tests/ directory and reconfigure with GoogleTest"
    },
    {
      "label": "CMake: Clean & Reconfigure (Sanitize)",
      "type": "shell",
      "command": "sh",
      "args": [
        "-c",
        "cmake -E remove_directory build/${input:toolchain}/sanitize && cmake -DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake -DCMAKE_BUILD_TYPE=Sanitize -DENABLE_TESTING=OFF -B build/${input:toolchain}/sanitize"
      ],
      "problemMatcher": [],
      "detail": "Remove build/${input:toolchain}/sanitize/ directory and reconfigure"
    },
    {
      "label": "CMake: Clean & Reconfigure (Sanitize + Tests)",
      "type": "shell",
      "command": "sh",
      "args": [
        "-c",
        "cmake -E remove_directory build/${input:toolchain}/sanitize-tests && cmake -DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake -DCMAKE_BUILD_TYPE=Sanitize -DENABLE_TESTING=ON -B build/${input:toolchain}/sanitize-tests"
      ],
      "options": {
        "env": { "CPATH": "" }
      },
      "problemMatcher": [],
      "detail": "Remove build/${input:toolchain}/sanitize-tests/ directory and reconfigure"
    },
    {
      "label": "CMake: Clean & Reconfigure (ThreadSanitize)",
      "type": "shell",
      "command": "sh",
      "args": [
        "-c",
        "cmake -E remove_directory build/${input:toolchain}/thread-sanitize && cmake -DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake -DCMAKE_BUILD_TYPE=ThreadSanitize -DENABLE_TESTING=OFF -B build/${input:toolchain}/thread-sanitize"
      ],
      "problemMatcher": [],
      "detail": "Remove build/${input:toolchain}/thread-sanitize/ directory and reconfigure"
    },
    {
      "label": "CMake: Clean & Reconfigure (ThreadSanitize + Tests)",
      "type": "shell",
      "command": "sh",
      "args": [
        "-c",
        "cmake -E remove_directory build/${input:toolchain}/thread-sanitize-tests && cmake -DCMAKE_TOOLCHAIN_FILE=${input:toolchain}-toolchain.cmake -DCMAKE_BUILD_TYPE=ThreadSanitize -DENABLE_TESTING=ON -B build/${input:toolchain}/thread-sanitize-tests"
      ],
      "options": {
        "env": { "CPATH": "" }
      },
      "problemMatcher": [],
      "detail": "Remove build/${input:toolchain}/thread-sanitize-tests/ directory and reconfigure"
    },

    //===----------------------------- RUN & TEST ------------------------------===//
    // These tasks execute built binaries and run tests.

    {
      "label": "Run: Test Binary [src/]",
      "type": "shell",
      "command": "./bin/${input:runTestTarget}",
      "options": {
        "cwd": "${workspaceFolder}/build/${input:toolchain}/debug"
      },
      "group": {
        "kind": "test",
        "isDefault": true
      },
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "dependsOn": ["CMake: Build All"],
      "problemMatcher": [],
      "detail": "Build and run selected test binary from src/"
    },
    {
      "label": "Run: App Binary [apps/]",
      "type": "shell",
      "command": "./bin/${input:runAppTarget}",
      "options": {
        "cwd": "${workspaceFolder}/build/${input:toolchain}/debug"
      },
      "group": "test",
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "clear": true
      },
      "dependsOn": ["CMake: Build All"],
      "problemMatcher": [],
      "detail": "Build and run selected app binary from apps/"
    },
    {
      "label": "Test: Run GoogleTest Suite",
      "type": "shell",
      "command": "ctest",
      "args": ["--output-on-failure", "--verbose"],
      "options": {
        "cwd": "${workspaceFolder}/build/${input:toolchain}/debug-tests",
        "env": { "CPATH": "" }
      },
      "group": "test",
      "dependsOn": ["CMake: Build (Debug + Tests)"],
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": [],
      "detail": "Run all GoogleTest unit tests (requires ENABLE_TESTING=ON)"
    },
    {
      "label": "Test: Run GoogleTest Suite (Sanitize)",
      "type": "shell",
      "command": "ctest",
      "args": ["--output-on-failure", "--verbose"],
      "options": {
        "cwd": "${workspaceFolder}/build/${input:toolchain}/sanitize-tests",
        "env": { "CPATH": "" }
      },
      "group": "test",
      "dependsOn": ["CMake: Build (Sanitize + Tests)"],
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": [],
      "detail": "Run GoogleTest suite with AddressSanitizer and UBSan enabled"
    },
    {
      "label": "Test: Run GoogleTest Suite (ThreadSanitize)",
      "type": "shell",
      "command": "ctest",
      "args": ["--output-on-failure", "--verbose"],
      "options": {
        "cwd": "${workspaceFolder}/build/${input:toolchain}/thread-sanitize-tests",
        "env": { "CPATH": "" }
      },
      "group": "test",
      "dependsOn": ["CMake: Build (ThreadSanitize + Tests)"],
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": [],
      "detail": "Run GoogleTest suite with ThreadSanitizer enabled"
    },

    //===---------------------------- UTILITY TASKS ----------------------------===//
    // Code formatting, linting, and other development utilities.

    {
      "label": "Format: clang-format Active File",
      "type": "shell",
      "command": "clang-format",
      "args": ["-i", "${file}"],
      "problemMatcher": [],
      "detail": "Format current file with clang-format"
    },
    {
      "label": "Lint: clang-tidy Active File",
      "type": "shell",
      "command": "clang-tidy",
      "args": ["${file}", "--", "-std=c++20"],
      "problemMatcher": ["$gcc"],
      "detail": "Run clang-tidy on current file"
    }
  ],

  //===-------------------------- INPUT DEFINITIONS ---------------------------===//
  // User-configurable variables used across multiple tasks.
  // These reduce duplication and make tasks easier to customize.

  "inputs": [
    {
      "id": "toolchain",
      "type": "pickString",
      "description": "Select toolchain family",
      "options": ["clang", "gcc"],
      "default": "clang"
    },
    {
      "id": "buildJobs",
      "type": "pickString",
      "description": "Number of parallel build jobs",
      "options": ["4", "8", "12", "16"],
      "default": "8"
    },
    {
      "id": "testTarget",
      "type": "pickString",
      "description": "Select test target to build [src/]",
      "options": [
        "test_Static_Array",
        "test_Dynamic_Array",
        "test_Circular_Array",
        "test_Singly_Linked_List",
        "test_Doubly_Linked_List",
        "test_Circular_Linked_List",
        "test_Stacks_Queues",
        "test_Deque",
        "test_Priority_Queue",
        "test_Complete_Binary_Tree",
        "test_BST",
        "test_BBT",
        "test_AVL",
        "test_RBT",
        "test_Trie",
        "test_Fenwick_Tree",
        "test_Segment_Tree",
        "test_Dijkstra",
        "test_Graph_ADJ_List",
        "test_Graph_ADJ_Matrix",
        "test_Disjoint_Set_Union",
        "test_Tree_Map",
        "test_HashMap",
        "test_Hash_Chaining",
        "test_Hash_Open_Addr",
        "test_Heaps"
      ],
      "default": "test_BST"
    },
    {
      "id": "appTarget",
      "type": "pickString",
      "description": "Select app target to build [apps/]",
      "options": ["app_Snake_TUI", "app_Snake_Stress"],
      "default": "app_Snake_TUI"
    },
    {
      "id": "runTestTarget",
      "type": "pickString",
      "description": "Select test binary to run [src/]",
      "options": [
        "test_Static_Array",
        "test_Dynamic_Array",
        "test_Circular_Array",
        "test_Singly_Linked_List",
        "test_Doubly_Linked_List",
        "test_Circular_Linked_List",
        "test_Stacks_Queues",
        "test_Deque",
        "test_Priority_Queue",
        "test_Complete_Binary_Tree",
        "test_BST",
        "test_BBT",
        "test_AVL",
        "test_RBT",
        "test_Trie",
        "test_Fenwick_Tree",
        "test_Segment_Tree",
        "test_Dijkstra",
        "test_Graph_ADJ_List",
        "test_Graph_ADJ_Matrix",
        "test_Disjoint_Set_Union",
        "test_Tree_Map",
        "test_HashMap",
        "test_Hash_Chaining",
        "test_Hash_Open_Addr",
        "test_Heaps"
      ],
      "default": "test_BST"
    },
    {
      "id": "runAppTarget",
      "type": "pickString",
      "description": "Select app binary to run [apps/]",
      "options": ["app_Snake_TUI", "app_Snake_Stress"],
      "default": "app_Snake_TUI"
    }
  ]
}
//===-------------------------------------------------------------------------===//
